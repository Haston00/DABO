<div class="p-8 max-w-6xl mx-auto">
    <div class="page-header">
        <h1 class="page-title">Plan Review</h1>
    </div>

    <div id="reviewNoProject" class="alert-warning" style="display:none;">
        Select a project in the sidebar first.
    </div>

    <div id="reviewContent" style="display:none;">
        <!-- Run review -->
        <div class="card mb-8">
            <h2 class="section-title">Run Conflict Detection</h2>
            <p class="text-gray-600 text-sm mb-4">Analyze all classified sheets for cross-discipline conflicts.</p>
            <button onclick="DABO.runReview()" class="btn-primary" id="reviewBtn">
                Run Plan Review
            </button>
            <div id="reviewSpinner" class="hidden mt-4">
                <div class="flex items-center gap-3">
                    <div class="spinner"></div>
                    <span class="text-gray-600 text-sm">Running cross-reference analysis and conflict detection...</span>
                </div>
            </div>
        </div>

        <!-- Results -->
        <div id="reviewResults" class="hidden">
            <!-- Metrics -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="metric-card">
                    <div class="metric-value" id="reviewSheets">0</div>
                    <div class="metric-label">Sheets Analyzed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="reviewDiscs">0</div>
                    <div class="metric-label">Disciplines</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="reviewRulesChecked">0</div>
                    <div class="metric-label">Rules Checked</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="reviewRulesTriggered">0</div>
                    <div class="metric-label">Rules Triggered</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value text-red-600" id="reviewConflicts">0</div>
                    <div class="metric-label">Conflicts Found</div>
                </div>
            </div>

            <!-- Severity chart -->
            <div class="card mb-6">
                <h2 class="section-title">Severity Distribution</h2>
                <div class="chart-container" style="height: 250px; max-width: 400px; margin: 0 auto;">
                    <canvas id="severityChart"></canvas>
                </div>
            </div>

            <!-- Conflict cards -->
            <div class="card">
                <h2 class="section-title">Conflicts</h2>
                <div id="conflictList" class="space-y-3"></div>
                <div id="noConflicts" class="hidden">
                    <div class="text-center py-8 text-green-600">
                        <svg class="w-12 h-12 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                        <p class="font-semibold">No conflicts detected</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    DABO.requireProject('reviewContent', 'reviewNoProject');
});
</script>
