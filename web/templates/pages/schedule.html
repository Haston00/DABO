<div class="p-8 max-w-full mx-auto">
    <div class="page-header">
        <h1 class="page-title">Schedule</h1>
    </div>

    <div id="scheduleNoProject" class="alert-warning" style="display:none;">
        Select a project in the sidebar first.
    </div>

    <div id="scheduleContent" style="display:none;">
        <!-- Generate schedule -->
        <div class="card mb-8">
            <h2 class="section-title">Generate CPM Schedule</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="form-label">Project Start Date</label>
                    <input type="date" id="schedStartDate" class="form-input" value="2026-04-01">
                </div>
                <div>
                    <label class="form-label">Building Type</label>
                    <div class="text-sm text-gray-600 mt-2" id="schedBuildType">&mdash;</div>
                </div>
                <div>
                    <label class="form-label">Square Feet</label>
                    <div class="text-sm text-gray-600 mt-2" id="schedSF">&mdash;</div>
                </div>
            </div>
            <button onclick="DABO.generateSchedule()" class="btn-primary" id="schedBtn">
                Generate Schedule
            </button>
            <div id="schedSpinner" class="hidden mt-4">
                <div class="flex items-center gap-3">
                    <div class="spinner"></div>
                    <span class="text-gray-600 text-sm">Building activities and computing CPM...</span>
                </div>
            </div>
        </div>

        <!-- Schedule results -->
        <div id="schedResults" class="hidden">
            <!-- Metrics -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
                <div class="metric-card">
                    <div class="metric-value" id="schedActivities">0</div>
                    <div class="metric-label">Activities</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="schedDuration">0</div>
                    <div class="metric-label">Duration (days)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value text-red-600" id="schedCritical">0</div>
                    <div class="metric-label">Critical Path</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="schedMilestones">0</div>
                    <div class="metric-label">Milestones</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="schedFloat">&mdash;</div>
                    <div class="metric-label">Avg Float</div>
                </div>
            </div>

            <!-- Gantt chart â€” full width -->
            <div class="card mb-6" style="padding:0; overflow:hidden;">
                <div class="gantt-toolbar">
                    <h2 class="section-title mb-0" style="padding:0;">Gantt Chart</h2>
                    <div class="gantt-toolbar-right">
                        <button class="gantt-zoom-btn" onclick="DABO.ganttZoom('out')" title="Zoom out">-</button>
                        <span class="gantt-zoom-label" id="ganttZoomLabel">Weeks</span>
                        <button class="gantt-zoom-btn" onclick="DABO.ganttZoom('in')" title="Zoom in">+</button>
                        <button class="gantt-toggle-btn" onclick="DABO.ganttExpandAll()" title="Expand all">Expand All</button>
                        <button class="gantt-toggle-btn" onclick="DABO.ganttCollapseAll()" title="Collapse all">Collapse All</button>
                    </div>
                </div>
                <div class="gantt-wrapper" id="ganttWrapper">
                    <!-- Left: task list -->
                    <div class="gantt-table" id="ganttTable"></div>
                    <!-- Right: timeline bars -->
                    <div class="gantt-timeline-wrap" id="ganttTimelineWrap">
                        <div class="gantt-timeline-header" id="ganttTimelineHeader"></div>
                        <div class="gantt-timeline-body" id="ganttTimelineBody">
                            <svg class="gantt-svg" id="ganttSvg"></svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Critical path list -->
            <div class="card mb-6">
                <h2 class="section-title">Critical Path</h2>
                <div id="criticalPath" class="space-y-1"></div>
            </div>

            <!-- Download -->
            <div class="card">
                <button onclick="DABO.downloadScheduleExcel()" class="btn-primary">
                    Download P6-Compatible Excel
                </button>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    DABO.requireProject('scheduleContent', 'scheduleNoProject');
    DABO.loadScheduleProjectInfo();
});
</script>
